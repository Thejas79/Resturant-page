<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Swaad — Indian Eatery (Timered Orders)</title>
    <link rel=" shortcut icon" href="icon.png" />
    <style>
      :root {
        --bg: #f7f6f4;
        --card: #ffffff;
        --accent: #d35400;
        --muted: #666;
        --glass: rgba(255, 255, 255, 0.95);
      }
      * {
        box-sizing: border-box;
      }
      body {
        font-family: Inter, system-ui, Segoe UI, Roboto, Arial;
        margin: 0;
        background: linear-gradient(180deg, #fff 0%, var(--bg) 100%);
        color: #222;
      }
      .topbar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 14px 24px;
        background: var(--card);
        box-shadow: 0 4px 18px rgba(20, 20, 20, 0.06);
      }
      .brand {
        font-weight: 700;
        font-size: 20px;
        color: var(--accent);
      }
      .cart-btn {
        background: transparent;
        border: 1px solid #eee;
        padding: 8px 12px;
        border-radius: 10px;
        cursor: pointer;
      }
      .hero {
        display: flex;
        gap: 24px;
        align-items: center;
        padding: 36px 24px;
      }
      .hero-content {
        max-width: 640px;
      }
      .hero-content h1 {
        margin: 0 0 8px;
        font-size: 34px;
      }
      .hero-content p {
        margin: 0 0 16px;
        color: var(--muted);
      }
      .primary {
        background: var(--accent);
        color: #fff;
        padding: 10px 14px;
        border: none;
        border-radius: 10px;
        cursor: pointer;
      }
      .hero-image {
        width: 320px;
        height: 180px;
        border-radius: 12px;
        background-image: url("butterchicken.jpg");
        background-size: cover;
        background-position: center;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.12);
      }
      .menu-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
        gap: 18px;
        padding: 20px;
      }
      .card {
        background: var(--card);
        border-radius: 12px;
        padding: 12px;
        box-shadow: 0 8px 18px rgba(10, 10, 10, 0.05);
        display: flex;
        flex-direction: column;
        gap: 8px;
        min-height: 320px;
      }
      .food-image img {
        width: 100%;
        height: 160px;
        object-fit: cover;
        border-radius: 10px;
      }
      .card h4 {
        margin: 0;
        font-size: 18px;
      }
      .row {
        display: flex;
        gap: 8px;
        align-items: center;
      }
      .price {
        font-weight: 700;
      }
      .rating {
        background: #fdebd0;
        padding: 4px 8px;
        border-radius: 8px;
        font-size: 13px;
      }
      .controls {
        display: flex;
        gap: 8px;
        align-items: center;
        margin-top: auto;
      }
      .qty {
        width: 70px;
        padding: 6px;
        border: 1px solid #eee;
        border-radius: 8px;
      }
      .btn-small {
        padding: 8px 10px;
        border-radius: 8px;
        border: none;
        cursor: pointer;
      }
      .add {
        background: #2ecc71;
        color: white;
      }
      .cart-panel {
        position: fixed;
        right: 20px;
        top: 80px;
        width: 360px;
        background: var(--glass);
        backdrop-filter: blur(6px);
        border-radius: 12px;
        padding: 12px;
        box-shadow: 0 18px 40px rgba(0, 0, 0, 0.12);
      }
      .hidden {
        display: none;
      }
      .cart-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      .cart-items {
        max-height: 320px;
        overflow: auto;
        margin-top: 10px;
      }
      .cart-item {
        display: flex;
        gap: 10px;
        align-items: center;
        padding: 8px;
        border-bottom: 1px dashed #eee;
      }
      .cart-item img {
        width: 54px;
        height: 44px;
        object-fit: cover;
        border-radius: 6px;
      }
      .cart-footer {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 12px;
      }
      .modal {
        position: fixed;
        inset: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        background: rgba(0, 0, 0, 0.45);
        z-index: 999;
      }
      .modal.hidden {
        display: none;
      }
      .modal-content {
        background: var(--card);
        padding: 18px;
        border-radius: 12px;
        min-width: 320px;
        box-shadow: 0 12px 30px rgba(0, 0, 0, 0.2);
      }
      .modal-actions {
        display: flex;
        justify-content: flex-end;
        margin-top: 12px;
      }
      .modal h3 {
        margin: 0 0 8px;
      }
      .timer {
        font-size: 20px;
        font-weight: 700;
        margin-top: 8px;
        color: var(--accent);
      }
      .footer {
        padding: 16px;
        text-align: center;
        color: var(--muted);
        font-size: 13px;
      }
      @media (max-width: 700px) {
        .hero {
          flex-direction: column;
        }
        .hero-image {
          width: 100%;
          height: 180px;
        }
        .cart-panel {
          left: 12px;
          right: 12px;
          top: auto;
          bottom: 12px;
          width: auto;
        }
      }
    </style>
  </head>
  <body>
    <header class="topbar">
      <div class="brand">Swaad — Indian Eatery</div>
      <div
        class="cart-btn"
        id="cartBtn"
        aria-controls="cartPanel"
        aria-expanded="false"
      >
        Cart (<span id="cartCount">0</span>)
      </div>
    </header>

    <main>
      <section class="hero">
        <div class="hero-content">
          <h1>Order at your table — not delivery</h1>
          <p>
            Choose dishes, set number of plates, place order — we’ll prepare and
            serve right away.
          </p>
          <button id="viewMenuBtn" class="primary">View Menu</button>
        </div>
        <div class="hero-image" aria-hidden="true"></div>
      </section>

      <section id="menu" class="menu-grid" aria-live="polite"></section>
    </main>

    <aside
      id="cartPanel"
      class="cart-panel hidden"
      role="dialog"
      aria-label="Cart"
    >
      <div class="cart-header">
        <h2>Your Order</h2>
        <button id="closeCart">Close</button>
      </div>
      <div id="cartItems" class="cart-items"></div>
      <div class="cart-footer">
        <div class="total">Total: ₹<span id="totalAmount">0</span></div>
        <button id="placeOrder" class="primary" disabled>Place Order</button>
      </div>
    </aside>

    <!-- Status modal: used for preparing/countdown/done -->
    <div
      id="statusModal"
      class="modal hidden"
      role="alertdialog"
      aria-hidden="true"
    >
      <div class="modal-content">
        <h3 id="statusTitle">Status</h3>
        <p id="statusMessage"></p>
        <div
          id="countdown"
          class="timer"
          aria-live="polite"
          style="display: none"
        >
          03:00
        </div>
        <div class="modal-actions">
          <button id="closeStatus">Close</button>
        </div>
      </div>
    </div>

    <footer class="footer">© Swaad — Indian Eatery</footer>

    <script>
      // ====== CONFIG / DATA ======
      const menuItems = [
        {
          id: 1,
          name: "Butter Chicken",
          price: 280,
          rating: 4.8,
          img: "butterchicken.jpg",
        },
        {
          id: 2,
          name: "Hyderabadi Biryani",
          price: 240,
          rating: 4.7,
          img: "biriyani.jpg",
        },
        {
          id: 3,
          name: "Paneer Tikka",
          price: 240,
          rating: 4.9,
          img: "paneertikka.jpg",
        },
        {
          id: 4,
          name: "Samosa (2 pcs)",
          price: 80,
          rating: 4.6,
          img: "samosa.jpg",
        },
        {
          id: 5,
          name: "Masala Dosa",
          price: 120,
          rating: 4.4,
          img: "dosa.jpg",
        },
        {
          id: 6,
          name: "Tandoori Chicken",
          price: 320,
          rating: 4.9,
          img: "tandoori.jpg",
        },
        {
          id: 7,
          name: "Chole Bhature",
          price: 150,
          rating: 4.7,
          img: "chole.jpg",
        },
        { id: 8, name: "Lassi", price: 70, rating: 4.6, img: "lassi.jpg" },
        {
          id: 9,
          name: "Gulab Jamun (2)",
          price: 90,
          rating: 4.5,
          img: "jamoon.jpg",
        },
        {
          id: 10,
          name: "Naan Basket",
          price: 60,
          rating: 4.1,
          img: "naan.jpg",
        },
      ];

      // ====== UI ELEMENTS ======
      const menuEl = document.getElementById("menu");
      const cartBtn = document.getElementById("cartBtn");
      const cartPanel = document.getElementById("cartPanel");
      const cartItemsEl = document.getElementById("cartItems");
      const cartCountEl = document.getElementById("cartCount");
      const totalAmountEl = document.getElementById("totalAmount");
      const placeOrderBtn = document.getElementById("placeOrder");
      const viewMenuBtn = document.getElementById("viewMenuBtn");

      // Modal & countdown
      const statusModal = document.getElementById("statusModal");
      const statusTitle = document.getElementById("statusTitle");
      const statusMessage = document.getElementById("statusMessage");
      const countdownEl = document.getElementById("countdown");
      const closeStatus = document.getElementById("closeStatus");

      // ====== STATE ======
      let cart = [];
      let countdownInterval = null;
      let countdownEnd = null;

      // ====== RENDER MENU ======
      function renderMenu() {
        menuEl.innerHTML = "";
        menuItems.forEach((item) => {
          const card = document.createElement("div");
          card.className = "card";
          card.innerHTML = `
        <div class="food-image"><img src="${item.img}" alt="${
            item.name
          }" onerror="this.style.opacity=.25"></div>
        <h4>${item.name}</h4>
        <div class="row">
          <div class="price">₹${item.price}</div>
          <div class="rating">★ ${item.rating.toFixed(1)}</div>
        </div>
        <div class="controls">
          <input type="number" min="1" value="1" class="qty" data-id="${
            item.id
          }" />
          <button class="btn-small add" data-id="${item.id}">Add</button>
        </div>
      `;
          menuEl.appendChild(card);
        });
      }

      // ====== CART LOGIC ======
      function findMenuItem(id) {
        return menuItems.find((m) => m.id === id);
      }

      function addToCart(id, qty) {
        const existing = cart.find((i) => i.id === id);
        if (existing) {
          existing.qty += qty;
        } else {
          cart.push({ id, qty });
        }
        updateCartUI();
      }

      function updateCartUI() {
        cartItemsEl.innerHTML = "";
        let total = 0;
        cart.forEach((ci) => {
          const item = findMenuItem(ci.id);
          const div = document.createElement("div");
          div.className = "cart-item";
          div.innerHTML = `
        <img src="${item.img}" alt="${item.name}" />
        <div style="flex:1">
          <div style="font-weight:700">${item.name}</div>
          <div>₹${item.price} x ${ci.qty} = ₹${item.price * ci.qty}</div>
        </div>
        <div>
          <button class="btn-small" data-action="dec" data-id="${
            ci.id
          }">-</button>
          <button class="btn-small" data-action="inc" data-id="${
            ci.id
          }">+</button>
        </div>
      `;
          cartItemsEl.appendChild(div);
          total += item.price * ci.qty;
        });
        cartCountEl.textContent = cart.reduce((s, i) => s + i.qty, 0);
        totalAmountEl.textContent = total;
        placeOrderBtn.disabled = cart.length === 0;
      }

      // ====== EVENTS ======
      menuEl.addEventListener("click", (e) => {
        if (e.target.classList.contains("add")) {
          const id = Number(e.target.dataset.id);
          const input = document.querySelector(`.qty[data-id='${id}']`);
          const qty = Math.max(1, Number(input.value) || 1);
          addToCart(id, qty);
        }
      });

      menuEl.addEventListener("keydown", (e) => {
        if (e.target.classList.contains("qty") && e.key === "Enter") {
          const id = Number(e.target.dataset.id);
          const qty = Math.max(1, Number(e.target.value) || 1);
          addToCart(id, qty);
        }
      });

      cartBtn.addEventListener("click", () => {
        cartPanel.classList.toggle("hidden");
      });
      document
        .getElementById("closeCart")
        .addEventListener("click", () => cartPanel.classList.add("hidden"));

      cartItemsEl.addEventListener("click", (e) => {
        const action = e.target.dataset.action;
        const id = Number(e.target.dataset.id);
        if (!action) return;
        const ci = cart.find((i) => i.id === id);
        if (!ci) return;
        if (action === "inc") ci.qty++;
        if (action === "dec") ci.qty = Math.max(0, ci.qty - 1);
        cart = cart.filter((i) => i.qty > 0);
        updateCartUI();
      });

      // ====== ORDER + COUNTDOWN ======
      placeOrderBtn.addEventListener("click", () => {
        if (cart.length === 0) return;
        // snapshot & clear cart
        const order = cart.map((ci) => ({ ...ci }));
        cart = [];
        updateCartUI();
        cartPanel.classList.add("hidden");

        // Immediate feedback
        showStatus(
          "Order Placed",
          "Your order has been placed with the kitchen.",
          false
        );

        // After a short delay, start the 3 minute preparing countdown
        setTimeout(() => startPreparingCountdown(3 * 60), 700);
      });

      // ====== MODAL / COUNTDOWN HELPERS ======
      function showStatus(title, message, showTimer) {
        if (!statusModal || !countdownEl) {
          console.error("Modal or countdown element missing", {
            statusModal,
            countdownEl,
          });
          return;
        }
        statusTitle.textContent = title;
        statusMessage.textContent = message;
        countdownEl.style.display = showTimer ? "block" : "none";
        statusModal.classList.remove("hidden");
        document.body.style.overflow = "hidden";
        console.log("SHOW STATUS:", title);
      }

      function hideStatus() {
        statusModal.classList.add("hidden");
        document.body.style.overflow = "";
        clearCountdown();
        console.log("HIDE STATUS");
      }

      function startPreparingCountdown(seconds) {
        // safety guard
        if (typeof seconds !== "number" || seconds <= 0) seconds = 180;
        // compute end time
        countdownEnd = Date.now() + seconds * 1000;
        // make sure any previous interval is cleared
        clearCountdown();
        // show
        showStatus(
          "Food is being prepared",
          "We are preparing your food — time remaining:",
          true
        );
        // immediate render
        renderCountdown();
        // interval
        countdownInterval = setInterval(renderCountdown, 1000);
        console.log("COUNTDOWN STARTED for", seconds, "sec");
      }

      function renderCountdown() {
        if (!countdownEnd) {
          console.warn("renderCountdown called but countdownEnd is null");
          return;
        }
        const remainingMs = countdownEnd - Date.now();
        if (remainingMs <= 0) {
          clearCountdown();
          countdownEl.textContent = "00:00";
          // final update
          statusTitle.textContent = "Done — Food is on the table";
          statusMessage.textContent =
            "Your order is ready and placed on your table. Enjoy!";
          console.log("COUNTDOWN FINISHED");
          return;
        }
        const s = Math.floor(remainingMs / 1000);
        const mm = String(Math.floor(s / 60)).padStart(2, "0");
        const ss = String(s % 60).padStart(2, "0");
        countdownEl.textContent = `${mm}:${ss}`;
        // for debug
        // console.log('COUNTDOWN', mm+':'+ss);
      }

      function clearCountdown() {
        if (countdownInterval) {
          clearInterval(countdownInterval);
          countdownInterval = null;
          countdownEnd = null;
          console.log("COUNTDOWN CLEARED");
        }
      }

      // ====== MODAL CLOSE BEHAVIOR ======
      closeStatus.addEventListener("click", hideStatus);
      statusModal.addEventListener("click", (e) => {
        if (e.target === statusModal) hideStatus();
      });
      document.addEventListener("keydown", (e) => {
        if (e.key === "Escape" && !statusModal.classList.contains("hidden"))
          hideStatus();
      });

      // ====== INIT ======
      renderMenu();
      updateCartUI();
      viewMenuBtn.addEventListener(
        "click",
        () => (window.location.hash = "#menu")
      );

      // ====== QUICK DEBUG HELP ======
      // If clock still doesn't run: open DevTools Console (F12) and look for errors or the console logs above..
      // You'll see LOGs like "COUNTDOWN STARTED" / "COUNTDOWN FINISHED" / "COUNTDOWN CLEARED".
      console.log("Script loaded — ready");
    </script>
  </body>
</html>
